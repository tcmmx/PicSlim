# PicSlim 打包说明

## 设置EXE图标和名称

### 方法一：使用打包脚本（推荐）

#### Windows用户
直接运行 `build.bat` 文件：
```bash
build.bat
```

#### 所有平台
运行Python脚本：
```bash
python build.py
```

### 方法二：手动使用PyInstaller

#### 基本命令
```bash
pyinstaller -F -w -i icon.ico --name "图片缩放工具" main.py
```

#### 参数说明
- `-F`: 打包为单个EXE文件（推荐）
- `-w`: 无控制台窗口（纯GUI程序）
- `-i icon.ico`: 设置图标文件（可选，需要.ico格式）
- `--name "图片缩放工具"`: 设置生成的EXE文件名
- `--clean`: 清理临时文件（可选）
- `main.py`: 主程序文件

### 准备图标文件

#### 1. 图标格式要求
- **必须使用 .ico 格式**（Windows系统要求）
- 推荐尺寸：256×256 或 128×128 像素
- 支持多尺寸的ICO文件（16×16, 32×32, 48×48, 256×256）
- **✅ 完全支持透明度**：ICO格式支持Alpha通道，圆形图标、透明背景都可以完美显示

#### 为什么必须是ICO格式？
Windows的EXE文件图标系统只支持ICO格式，这是Windows操作系统的要求。虽然你的源文件可能是PNG（圆形、透明背景），但最终必须转换为ICO格式才能用作EXE图标。

#### 圆形图标支持
如果你的图标是圆形的（有透明背景的PNG），完全没问题！ICO格式支持透明度，转换后会完美保留圆形效果。

#### 2. 如何创建ICO文件

**方法A：在线转换**
1. 准备一张PNG图片（推荐256×256或更大）
2. 访问在线转换工具：
   - https://convertio.co/zh/png-ico/
   - https://www.icoconverter.com/
3. 上传PNG图片，下载ICO文件
4. 将文件重命名为 `icon.ico` 并放在项目根目录

**方法B：使用提供的转换脚本（最简单，推荐）**
项目已包含 `convert_icon.py` 脚本，直接运行：
```bash
python convert_icon.py your_icon.png
```
或者直接拖拽PNG文件到脚本上。

**方法C：使用Python代码转换（保留透明度）**
```python
from PIL import Image

# 将PNG转换为ICO（保留透明度，支持圆形图标）
img = Image.open('your_image.png')  # 你的圆形PNG图标

# 如果图片是RGBA模式（带透明度），直接保存
# 如果是RGB模式，需要转换为RGBA
if img.mode != 'RGBA':
    img = img.convert('RGBA')

# 保存为ICO，包含多个尺寸（保留透明度）
img.save('icon.ico', format='ICO', sizes=[
    (256, 256),  # 大图标
    (128, 128),  # 中等图标
    (64, 64),    # 小图标
    (32, 32),    # 更小图标
    (16, 16)     # 最小图标
])
```

**注意**：如果你的PNG图标是圆形的（有透明背景），转换时会自动保留透明度！ICO格式完全支持Alpha通道。

**方法C：使用工具**
- Windows: 使用 IcoFX、IconWorkshop 等工具
- 在线: https://www.favicon-generator.org/

#### 3. 图标文件位置
将 `icon.ico` 文件放在项目根目录（与 `main.py` 同级）

### 自定义EXE名称

在打包命令中修改 `--name` 参数：
```bash
pyinstaller -F -w -i icon.ico --name "你的程序名称" main.py
```

**注意**：
- 名称中不要包含特殊字符（如 `\ / : * ? " < > |`）
- 建议使用中文或英文，避免空格

### 完整打包示例

#### 示例1：带图标和自定义名称
```bash
pyinstaller -F -w -i icon.ico --name "图片缩放工具" --clean main.py
```

#### 示例2：不带图标（使用默认图标）
```bash
pyinstaller -F -w --name "图片缩放工具" --clean main.py
```

#### 示例3：打包为文件夹（非单文件）
```bash
pyinstaller -w -i icon.ico --name "图片缩放工具" main.py
```
（去掉 `-F` 参数，会生成一个包含所有文件的文件夹）

### 打包后的文件位置

打包完成后，生成的EXE文件位于：
```
dist/图片缩放工具.exe
```

### 常见问题

#### Q: 打包后EXE文件很大？
A: 这是正常的，因为PyInstaller会将Python解释器和所有依赖库打包进去。单文件模式（-F）会更大。

#### Q: 打包后运行很慢？
A: 首次运行需要解压，属于正常现象。后续运行会快一些。

#### Q: 图标没有显示？
A: 检查以下几点：
1. 图标文件是否为.ico格式
2. 图标文件路径是否正确
3. 尝试重新生成图标文件
4. Windows可能需要刷新图标缓存

#### Q: 如何减小EXE体积？
A: 可以：
1. 使用 `--exclude-module` 排除不需要的模块
2. 使用文件夹模式（去掉 `-F`）而不是单文件模式
3. 使用UPX压缩（需要安装UPX）

### 高级选项

#### 添加版本信息（Windows）
创建 `version.txt` 文件，然后使用：
```bash
pyinstaller -F -w -i icon.ico --name "图片缩放工具" --version-file version.txt main.py
```

#### 排除不需要的模块
```bash
pyinstaller -F -w -i icon.ico --name "图片缩放工具" --exclude-module matplotlib --exclude-module numpy main.py
```

### 依赖安装

确保已安装PyInstaller：
```bash
pip install pyinstaller
```

